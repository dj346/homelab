deploymentMode: Distributed

global:
  extraEnvFrom:
    - secretRef:
        name: loki-s3-credentials
  extraArgs: 
    - "-config.expand-env=true"

loki:
  ui:
    enabled: true
    gateway:
      enabled: true

  annotations: {}
  podAnnotations: {}
  podLabels: {}
  serviceAnnotations: {}
  serviceLabels: {}

  tenants: []

  schemaConfig:
    configs:
      - from: 2024-04-01
        store: tsdb
        object_store: s3
        schema: v13
        index:
          prefix: loki_index_
          period: 24h
  ingester:
    chunk_encoding: snappy
  tracing:
    enabled: true
  querier:
    max_concurrent: 4

  server:
    http_listen_port: 3100
    grpc_listen_port: 9095
    http_server_read_timeout: 600s
    http_server_write_timeout: 600s
  
  storage:
    bucketNames:
      chunks: loki-chunks
      ruler: loki-ruler
      admin: loki-admin
    type: s3
    s3:
      endpoint: minio:80
      region: us-west-1
      secretAccessKey: "${AWS_SECRET_ACCESS_KEY}"
      accessKeyId: "${AWS_ACCESS_KEY_ID}"
      insecure: true

    object_store:
      type: s3
      storage_prefix: null
      s3:
        endpoint: minio:80
        region: us-west-1
        access_key_id: "${AWS_ACCESS_KEY_ID}"
        secret_access_key: "${AWS_SECRET_ACCESS_KEY}"
        insecure: true

  memcached:
    chunk_cache:
      enabled: false
    results_cache:
      enabled: false
  
adminApi:
  replicas: 1
  hostAliases: []
  extraArgs: {}
  labels: {}
  annotations: {}

  service:
    labels: {}
    annotations: {}

gateway:
  enabled: true
  replicas: 1
  containerPort: 8080
  verboseLogging: true
  autoscaling:
    enabled: false
    minReplicas: 1
    maxReplicas: 3
    targetCPUUtilizationPercentage: 60
    targetMemoryUtilizationPercentage:

  annotations: {}
  podAnnotations: {}
  podLabels: {}
 
  resources: {}
  
  service:
    port: 80
    type: ClusterIP
    clusterIP: null
    nodePort: null
    loadBalancerIP: null
    annotations: {}
    labels: {}

  ingress:
    enabled: false
    ingressClassName: ""
    annotations: {}
    labels: {}
    hosts:
      - host: gateway.loki.example.com
        paths:
          - path: /
    tls:
      - secretName: loki-gateway-tls
        hosts:
          - gateway.loki.example.com

  basicAuth:
    enabled: false
    username: null
    password: null
    
ingress:
  enabled: false
  annotations: {}
  labels: {}
  hosts:
    - loki.example.com
  tls: []

write:
  replicas: 0
  autoscaling:
    enabled: false
    minReplicas: 2
    maxReplicas: 6
    targetCPUUtilizationPercentage: 60
    targetMemoryUtilizationPercentage:
    
  priorityClassName: null
  annotations: {}
  podAnnotations: {}
  podLabels: {}
  selectorLabels: {}
  service:
    annotations: {}
    labels: {}

  resources: {}
  
  persistence:
    volumeClaimsEnabled: false
    dataVolumeParameters:
      emptyDir: {}
    enableStatefulSetAutoDeletePVC: false
    size: 10Gi
    storageClassName: ""
    storageClass: null
    selector: null
    annotations: {}

read:
  replicas: 0
  autoscaling:
    enabled: false
    minReplicas: 2
    maxReplicas: 6
    targetCPUUtilizationPercentage: 60
    targetMemoryUtilizationPercentage:

  annotations: {}
  podAnnotations: {}
  podLabels: {}
  selectorLabels: {}
  service:
    annotations: {}
    labels: {}
  
  resources: {}
  
  persistence:
    enableStatefulSetAutoDeletePVC: false
    size: 10Gi
    storageClassName: ""
    storageClass: null
    selector: null
    annotations: {}

backend:
  replicas: 0
  autoscaling:
    enabled: false
    minReplicas: 3
    maxReplicas: 6
   
  priorityClassName: null
  annotations: {}
  podAnnotations: {}
  podLabels: {}
  selectorLabels: {}
  service:
    annotations: {}
    labels: {}

  resources: {}

  persistence:
    volumeClaimsEnabled: false
    dataVolumeParameters:
      emptyDir: {}
    enableStatefulSetAutoDeletePVC: true
    size: 10Gi
    storageClassName: ""
    storageClass: null
    selector: null
    annotations: {}

singleBinary:
  replicas: 0

ingester:
  replicas: 3
  
  autoscaling:
    enabled: false
    minReplicas: 1
    maxReplicas: 3
    targetCPUUtilizationPercentage: 60
    targetMemoryUtilizationPercentage: null
    
    behavior:
      enabled: false
      scaleDown: {}
      scaleUp: {}
  
  podLabels: {}
  podAnnotations: {}
  serviceLabels: {}
  serviceAnnotations: {}
  resources: {}
  
  persistence:
    enabled: true
    inMemory: false
    claims:
      - name: data
        size: 3Gi
        storageClassName: "longhorn"
        
    enableStatefulSetAutoDeletePVC: false
    whenDeleted: Retain
    whenScaled: Retain
  
  zoneAwareReplication:
    enabled: true
    
    zoneA:
      annotations: {}
      podAnnotations: {}
    zoneB:
      annotations: {}
      podAnnotations: {}
    zoneC:
      annotations: {}
      podAnnotations: {}

distributor:
  replicas: 3
  maxUnavailable: 2
  
  autoscaling:
    enabled: false
    minReplicas: 1
    maxReplicas: 3
    targetCPUUtilizationPercentage: 60
    
    behavior:
      enabled: false
      scaleDown: {}
      scaleUp: {}

  podLabels: {}
  podAnnotations: {}
  serviceLabels: {}
  serviceAnnotations: {}
  
  resources: {}
  
querier:
  replicas: 3
  maxUnavailable: 2
  
  autoscaling:
    enabled: false
    minReplicas: 1
    maxReplicas: 3
    targetCPUUtilizationPercentage: 60
    
    behavior:
      enabled: false
      scaleDown: {}
      scaleUp: {}
  
  podLabels: {}
  podAnnotations: {}
  serviceLabels: {}
  serviceAnnotations: {}

  resources: {}
  
  persistence:
    enabled: true
    size: 3Gi
    storageClassName: "longhorn"
    storageClass: null
    annotations: {}

queryFrontend:
  replicas: 2
  maxUnavailable: 1

  autoscaling:
    enabled: false
  
    minReplicas: 1
    maxReplicas: 3
    targetCPUUtilizationPercentage: 60
    targetMemoryUtilizationPercentage: null
    
    behavior:
      enabled: false
      scaleDown: {}
      scaleUp: {}
  
  podLabels: {}
  podAnnotations: {}
  serviceLabels: {}
  serviceAnnotations: {}
  
  resources: {}
  
queryScheduler:
  replicas: 2

  podLabels: {}
  podAnnotations: {}
  serviceLabels: {}
  serviceAnnotations: {}
  resources: {}

indexGateway:
  replicas: 2
  maxUnavailable: 1
  
  podLabels: {}
  podAnnotations: {}
  serviceLabels: {}
  serviceAnnotations: {}
  
  resources: {}
  
  persistence:
    enabled: false
    inMemory: false
    size: 3Gi
    storageClassName: "longhorn"
    storageClass: null
    annotations: {}
    whenDeleted: Retain
    whenScaled: Retain
  
compactor:
  replicas: 1

  podLabels: {}
  podAnnotations: {}
  
  serviceLabels: {}
  serviceAnnotations: {}
  
  resources: {}
  
  persistence:
    enabled: true
    size: 3Gi
    storageClassName: "longhorn"
    storageClass: null
    annotations: {}
    claims:
      - name: data
        size: 3Gi
        storageClassName: "longhorn"
        storageClass: null

    whenDeleted: Retain
    whenScaled: Retain

bloomGateway:
  replicas: 0
  
  podLabels: {}
  podAnnotations: {}
  
  serviceLabels: {}
  serviceAnnotations: {}
  
  resources: {}

  persistence:
    enabled: false
    annotations: {}
    claims:
      - name: data
        size: 10Gi
        storageClassName: ""
        storageClass: null
    whenDeleted: Retain
    whenScaled: Retain
  
bloomPlanner:
  replicas: 0

  podLabels: {}
  podAnnotations: {}
  
  serviceLabels: {}
  serviceAnnotations: {}
  
  resources: {}
  
  persistence:
    enabled: false
    annotations: {}
    claims:
      - name: data
        size: 10Gi
        storageClassName: ""
        storageClass: null
    whenDeleted: Retain
    whenScaled: Retain
  
bloomBuilder:
  replicas: 0

  autoscaling:
    enabled: false
    minReplicas: 1
    maxReplicas: 3
    targetCPUUtilizationPercentage: 60
    targetMemoryUtilizationPercentage: null

    behavior:
      enabled: false
  
  podLabels: {}
  podAnnotations: {}
  serviceLabels: {}
  serviceAnnotations: {}

  resources: {}

patternIngester:
  replicas: 0

  priorityClassName: null
  podLabels: {}
  podAnnotations: {}

  serviceLabels: {}
  serviceAnnotations: {}

  resources: {}

  persistence:
    enabled: false
    size: 10Gi
    storageClassName: ""
    storageClass: null
    annotations: {}

    claims:
      - name: data
        size: 10Gi
        storageClassName: ""
        storageClass: null

    enableStatefulSetAutoDeletePVC: false
    whenDeleted: Retain
    whenScaled: Retain
  
  serviceAccount:
    create: false
    annotations: {}

ruler:
  enabled: false
  sidecar: false
  replicas: 0

  podLabels: {}
  podAnnotations: {}
  serviceLabels: {}
  serviceAnnotations: {}

  resources: {}

  persistence:
    enabled: false
    size: 3Gi
    storageClassName: "longhorn"
    storageClass: null
    annotations: {}

overridesExporter:
  enabled: false
  replicas: 0

  podLabels: {}
  podAnnotations: {}
  serviceLabels: {}
  serviceAnnotations: {}
  resources: {}

memcachedExporter:
  enabled: true
  resources:
    requests: {}
    limits: {}

resultsCache:
  enabled: true
  replicas: 1
  port: 11211
  annotations: {}

  priorityClassName: null
  podLabels: {}
  podAnnotations: {}

  resources: null

  service:
    annotations: {}
    labels: {}

  persistence:
    enabled: false
    storageSize: 10G
    storageClassName: ""
    storageClass: null
    mountPath: /data

chunksCache:
  enabled: true
  parallelism: 5
  replicas: 1
  port: 11211
  annotations: {}

  priorityClassName: null
  podLabels: {}
  podAnnotations: {}

  resources: null

  service:
    annotations: {}
    labels: {}

  persistence:
    enabled: true
    storageSize: 3G
    storageClassName: "longhorn"
    storageClass: null
    mountPath: /data

rollout_operator:
  enabled: false

minio:
  enabled: false
  replicas: 1
  drivesPerNode: 2
  rootUser: root-user
  rootPassword: supersecretpassword
  users:
    - accessKey: logs-user
      secretKey: supersecretpassword
      policy: readwrite
  buckets:
    - name: chunks
      policy: none
      purge: false
    - name: ruler
      policy: none
      purge: false
    - name: admin
      policy: none
      purge: false
  persistence:
    size: 5Gi
    annotations: {}
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
  address: null