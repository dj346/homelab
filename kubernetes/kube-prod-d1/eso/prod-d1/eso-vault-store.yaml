apiVersion: external-secrets.io/v1
kind: ClusterSecretStore
metadata:
  name: eso-vault-store
  namespace: eso
spec:
  provider:
    vault:
      server: "https://openbao-application-internal.openbao:8200"
      path: "kube-prod-d1"
      version: "v2"
      checkAndSet:
        required: true
      caProvider: 
        type: "Secret"
        namespace: "eso"
        name: "openbao-server-ca"
        key: "ca.crt"

      tls:
        certSecretRef:
          name: "eso-vault-certificate-secret"
          key: "tls.crt"
          namespace: "eso"
        keySecretRef:
          name: "eso-vault-certificate-secret"
          key: "tls.key"
          namespace: "eso"
      auth:
        kubernetes:
          mountPath: "kubernetes/kube-prod-d1"
          role: "eso-kube-prod-d1"
          serviceAccountRef:
            name: "eso-issuer-service-account"
            namespace: "eso"
            audiences:
              - "eso-vault-auth"